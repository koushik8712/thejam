{% extends "base.html" %}

{% block title %}{{ get_text('post_job') }}{% endblock %}

{% block content %}
<div class="post-job-container">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="flash-messages">
        {% for message in messages %}
        <p class="success">{{ message }}</p>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <h2>üì¢ {{ get_text('welcome') }}</h2>
    <nav>
        <a href="{{ url_for('dashboard') }}">‚Üê {{ get_text('back_to_dashboard') }}</a> |
        <a href="{{ url_for('search_jobs') }}">{{ get_text('search jobs') }}</a> |
        <a href="{{ url_for('saved_jobs') }}">{{ get_text('liked jobs') }}</a>
    </nav>
    <form action="{{ url_for('post_job') }}" method="POST" id="jobPostForm">
        <div class="form-group">
            <label for="title">{{ get_text('job_title') }} *</label>
            <select name="title" id="title" required>
                <option value="">{{ get_text('select_job') }}</option>
                {% for title in job_titles %} 
                <option value="{{ title }}" {% if form_data and form_data.title == title %}selected{% endif %}>
                    {{ get_text(title) }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="description">{{ get_text('job_description') }} *</label>
            <textarea name="description" id="description" rows="4" required>{{ form_data.description if form_data else '' }}</textarea>
        </div>

        <div class="form-group">
            <label for="location">{{ get_text('job_location') }} *</label>
            <input type="text" name="location" id="location" required value="{{ form_data.location if form_data else '' }}">
        </div>

        <div class="form-group">
            <label for="salary">{{ get_text('salary') }}</label>
            <input type="text" name="salary" id="salary" value="{{ form_data.salary if form_data else '' }}">
        </div>

        <div class="form-group">
            <label for="phone_number">{{ get_text('contact_info') }} *</label>
            <input type="text" name="phone_number" id="phone_number" required pattern="[0-9]{10}" value="{{ form_data.phone_number if form_data else '' }}">
        </div>

        <div class="form-group">
            <label for="job_type">{{ get_text('job_type') }} *</label>
            <select name="job_type" id="job_type" required>
                <option value="">{{ get_text('select_job_type') }}</option>
                <option value="full_time" {% if form_data and form_data.job_type == 'full_time' %}selected{% endif %}>{{ get_text('full_time') }}</option>
                <option value="part_time" {% if form_data and form_data.job_type == 'part_time' %}selected{% endif %}>{{ get_text('part_time') }}</option>
                <option value="contract" {% if form_data and form_data.job_type == 'contract' %}selected{% endif %}>{{ get_text('contract') }}</option>
            </select>
        </div>

        <button type="submit">{{ get_text('submit') }}</button>
    </form>

    <script>
        document.getElementById('jobPostForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            const location = document.getElementById('location').value.trim();
            const phone_number = document.getElementById('phone_number').value.trim();
            const job_type = document.getElementById('job_type').value.trim();
            
            let errors = [];
            
            if (!title) errors.push("Job Title is required");
            if (!description) errors.push("Description is required");
            if (!location) errors.push("Location is required");
            if (!phone_number) errors.push("Phone Number is required");
            if (!job_type) errors.push("Job Type is required");
            
            if (errors.length > 0) {
                alert(errors.join("\n"));
                return;
            }
            
            this.submit();
        });
    </script>
    <br>
</div>
{% endblock %}
